webpackJsonp([3],{275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(30),o=n.n(i),l=n(36),r=n.n(l),s=(n(1),n(102)),a=n(103),u={data:function(){return{menus:[],menuProps:{children:"children",label:"title"},menu:{id:0,title:"",parent_id:0,parent_title:"",route:"",is_enabled:!0,children:[]},isEdit:!1,isLoading:!1}},methods:{init:function(){this.query()},query:function(){var e=this;this.isLoading=!0,a.a.query().then(function(t){s.a.arrayToTree(t).then(function(t){e.menus=t,e.isLoading=!1})})},onSubmit:function(){var e=this,t=r()({},this.menu),n=t.id;t.id=void 0,t.parent_title=void 0,t.children=void 0,o.a.resolve(n?a.a.update(n,t):a.a.create(t)).then(function(t){e.onCancel(),e.query()})},onCancel:function(){this.isEdit=!1},refreshMenu:function(){},onAdd:function(e,t){r()(this.menu,{id:0,title:"",parent_id:t.id,parent_title:t.title,route:"",is_enabled:!0}),this.isEdit=!0},onEdit:function(e,t){r()(this.menu,t),this.isEdit=!0},onRemove:function(e,t){var n=this;this.$confirm("此操作将永久删除该菜单及其子菜单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.a.remove(t.id).then(function(e){n.$message({type:"success",message:"删除成功!"}),n.query()})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},renderContent:function(e,t){var n=this,i=t.node,o=t.data,l=t.store;return e("span",null,[e("span",{class:"el-tree-node__label"},[e("span",null,i.label)]),e("span",{style:"float: right; margin-right: 20px;"},[e("el-button",{style:i.level<3?"":"visibility:hidden;",attrs:{type:"success",size:"mini",icon:"plus"},on:{click:function(){return n.onAdd(l,o)}}},[""]),e("el-button",{style:o.parent_id?"":"visibility:hidden;",attrs:{type:"info",size:"mini",icon:"edit"},on:{click:function(){return n.onEdit(l,o,i)}}},[""]),e("el-button",{style:o.parent_id?"":"visibility:hidden;",attrs:{type:"danger",size:"mini",icon:"delete","v-popover":"popover5"},on:{click:function(){return n.onRemove(l,o)}}},[""])])])}},created:function(){this.init()}},d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.isLoading,expression:"isLoading",modifiers:{body:!0}}]},[n("el-row",{staticClass:"toolbar"},[n("div",{staticClass:"pull-right"},[n("el-button",{attrs:{type:"danger"},on:{click:e.refreshMenu}},[e._v("批量删除")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:!0},on:{click:e.refreshMenu}},[e._v("刷新菜单")])],1)]),e._v(" "),n("el-row",[n("el-col",{attrs:{span:8}},[n("el-tree",{attrs:{data:e.menus,"show-checkbox":"","default-expand-all":!0,"expand-on-click-node":!1,"node-key":"id","render-content":e.renderContent,props:e.menuProps}})],1),e._v(" "),n("el-col",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],attrs:{span:16}},[n("el-form",{ref:"form",attrs:{model:e.menu,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"父节点名称"}},[n("span",[e._v(e._s(e.menu.parent_title))])]),e._v(" "),n("el-form-item",{attrs:{label:"菜单名称"}},[n("el-input",{model:{value:e.menu.title,callback:function(t){e.menu.title=t},expression:"menu.title"}})],1),e._v(" "),e.menu.children.length?e._e():n("el-form-item",{attrs:{label:"菜单地址"}},[n("el-input",{model:{value:e.menu.route,callback:function(t){e.menu.route=t},expression:"menu.route"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否启用"}},[n("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.menu.is_enabled,callback:function(t){e.menu.is_enabled=t},expression:"menu.is_enabled"}})],1),e._v(" "),n("el-form-item",{attrs:{"label-width":"120px"}},[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.menu.id?"更新":"新增"))]),e._v(" "),n("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1)],1)],1)],1)],1)},c=[],m={render:d,staticRenderFns:c},p=m,f=n(0),v=f(u,p,null,null,null);t.default=v.exports}});